\hypertarget{grouper__fptr_8c}{\section{grouper\-\_\-fptr.\-c \-File \-Reference}
\label{grouper__fptr_8c}\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}}
}
{\ttfamily \#include $<$stdio.\-h$>$}\*
{\ttfamily \#include \char`\"{}flowy.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}auto\-\_\-comps.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}utils.\-h\char`\"{}}\*
\-Include dependency graph for grouper\-\_\-fptr.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{grouper__fptr_8c__incl}
\end{center}
\end{figure}
\subsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structuniq__records__tree}{uniq\-\_\-records\-\_\-tree}
\end{DoxyCompactItemize}
\subsection*{\-Defines}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{grouper__fptr_8c_a369266c24eacffb87046522897a570d5}{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}
\item 
\#define \hyperlink{grouper__fptr_8c_a9a46b7eff20f8b5c1ba0cdf539a37639}{tree\-\_\-item}(size)
\item 
\#define \hyperlink{grouper__fptr_8c_a881963bd9118daad87232f44c913d567}{comp}(size)
\item 
\#define \hyperlink{grouper__fptr_8c_a9b53ffe21e26564f099882d3eda95662}{comp\-\_\-p}(size)
\end{DoxyCompactItemize}
\subsection*{\-Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0}{int\-\_\-sizes} \{ \hyperlink{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a4a6ae3364fc34c58fdffe57616f5c5fa}{\-U\-I\-N\-T8\-\_\-\-T}, 
\hyperlink{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a07fc3a954750d581f9889dc9e774b6d8}{\-U\-I\-N\-T16\-\_\-\-T}, 
\hyperlink{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a3730ebad2bf66ba27c4976cc01395baa}{\-U\-I\-N\-T32\-\_\-\-T}, 
\hyperlink{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a70d80c278f2183c3306fd378838bfc25}{\-U\-I\-N\-T64\-\_\-\-T}
 \}
\end{DoxyCompactItemize}
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{grouper__fptr_8c_a2989d34d8f06d632175d4457103d2320}{tree\-\_\-item} (uint8\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_a54761cb1d00c192a9b4427bd3990932f}{tree\-\_\-item} (uint16\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_a44b986acfb0170de2ed2f93b5eee9447}{tree\-\_\-item} (uint32\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_ad0263c315d3f4b967c3bde99e0b79d40}{tree\-\_\-item} (uint64\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_a9cf378e44659c9794c4fe1823920b53f}{comp} (uint8\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_a92603134048c016522439b1aaa097b3a}{comp} (uint16\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_afa8a8cd22e54c1d8fc8ca18369c829db}{comp} (uint32\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_abc0df69d6b432e28aef229d90f08995d}{comp} (uint64\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_a7f2b2e509cf659c77653fc86648dfa44}{comp\-\_\-p} (uint8\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_a154c46403f6abdd06cbb5d39c210aae0}{comp\-\_\-p} (uint16\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_aa2a8894fb9fa7d1dbf8920626ea9e3f1}{comp\-\_\-p} (uint32\-\_\-t)
\item 
\hyperlink{grouper__fptr_8c_afc729afdead23ad53bba35b5490b4f34}{comp\-\_\-p} (uint64\-\_\-t)
\item 
struct \hyperlink{structuniq__records__tree}{uniq\-\_\-records\-\_\-tree} $\ast$ \hyperlink{grouper__fptr_8c_a286a39f0eb4a6f6cd878cb1d66dd274e}{build\-\_\-record\-\_\-trees} (char $\ast$$\ast$filtered\-\_\-records, size\-\_\-t num\-\_\-filtered\-\_\-records, struct \hyperlink{structgrouper__rule}{grouper\-\_\-rule} $\ast$group\-\_\-modules)
\item 
struct \hyperlink{structgroup}{group} $\ast$$\ast$ \hyperlink{grouper__fptr_8c_aa035e73fc4c57220877467d56e352ee1}{grouper} (char $\ast$$\ast$filtered\-\_\-records, size\-\_\-t num\-\_\-filtered\-\_\-records, struct \hyperlink{structgrouper__rule}{grouper\-\_\-rule} $\ast$group\-\_\-modules, int num\-\_\-group\-\_\-modules, struct \hyperlink{structgrouper__aggr}{grouper\-\_\-aggr} $\ast$\hyperlink{structaggr}{aggr}, size\-\_\-t num\-\_\-group\-\_\-aggr, size\-\_\-t $\ast$num\-\_\-groups)
\end{DoxyCompactItemize}


\subsection{\-Define \-Documentation}
\hypertarget{grouper__fptr_8c_a369266c24eacffb87046522897a570d5}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E@{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}}
\index{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E@{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf \-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}}}\label{grouper__fptr_8c_a369266c24eacffb87046522897a570d5}
\hypertarget{grouper__fptr_8c_a881963bd9118daad87232f44c913d567}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp@{comp}}
\index{comp@{comp}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf comp}(
\begin{DoxyParamCaption}
\item[{}]{size}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a881963bd9118daad87232f44c913d567}
{\bfseries \-Value\-:}
\begin{DoxyCode}
int comp_##size(const void *e1, const void *e2, void *thunk) \
{ \
    size x, y; \
    x = *(size *)(**(char ***)e1+*(size_t *)thunk); \
    y = *(size *)(**(char ***)e2+*(size_t *)thunk); \
    return (x > y) - (y > x); \
}
\end{DoxyCode}
\hypertarget{grouper__fptr_8c_a9b53ffe21e26564f099882d3eda95662}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp\-\_\-p@{comp\-\_\-p}}
\index{comp\-\_\-p@{comp\-\_\-p}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp\-\_\-p}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf comp\-\_\-p}(
\begin{DoxyParamCaption}
\item[{}]{size}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a9b53ffe21e26564f099882d3eda95662}
{\bfseries \-Value\-:}
\begin{DoxyCode}
int comp_##size##_p(const void *e1, const void *e2, void *thunk) \
{ \
    size x, y; \
    x = *(size *)((char *)e1+*(size_t *)thunk); \
    y = ((struct tree_item_uint32_t *)e2)->value; \
    return (x > y) - (y > x); \
}
\end{DoxyCode}
\hypertarget{grouper__fptr_8c_a9a46b7eff20f8b5c1ba0cdf539a37639}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!tree\-\_\-item@{tree\-\_\-item}}
\index{tree\-\_\-item@{tree\-\_\-item}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{tree\-\_\-item}]{\setlength{\rightskip}{0pt plus 5cm}\#define {\bf tree\-\_\-item}(
\begin{DoxyParamCaption}
\item[{}]{size}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a9a46b7eff20f8b5c1ba0cdf539a37639}
{\bfseries \-Value\-:}
\begin{DoxyCode}
struct tree_item_##size { \
    size value; \
    char ***ptr; \
};
\end{DoxyCode}


\subsection{\-Enumeration \-Type \-Documentation}
\hypertarget{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!int\-\_\-sizes@{int\-\_\-sizes}}
\index{int\-\_\-sizes@{int\-\_\-sizes}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{int\-\_\-sizes}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf int\-\_\-sizes}}}\label{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0}
\begin{Desc}
\item[\-Enumerator\-: ]\par
\begin{description}
\index{\-U\-I\-N\-T8\-\_\-\-T@{\-U\-I\-N\-T8\-\_\-\-T}!grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}}\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!\-U\-I\-N\-T8\-\_\-\-T@{\-U\-I\-N\-T8\-\_\-\-T}}\item[{\em 
\hypertarget{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a4a6ae3364fc34c58fdffe57616f5c5fa}{\-U\-I\-N\-T8\-\_\-\-T}\label{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a4a6ae3364fc34c58fdffe57616f5c5fa}
}]\index{\-U\-I\-N\-T16\-\_\-\-T@{\-U\-I\-N\-T16\-\_\-\-T}!grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}}\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!\-U\-I\-N\-T16\-\_\-\-T@{\-U\-I\-N\-T16\-\_\-\-T}}\item[{\em 
\hypertarget{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a07fc3a954750d581f9889dc9e774b6d8}{\-U\-I\-N\-T16\-\_\-\-T}\label{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a07fc3a954750d581f9889dc9e774b6d8}
}]\index{\-U\-I\-N\-T32\-\_\-\-T@{\-U\-I\-N\-T32\-\_\-\-T}!grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}}\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!\-U\-I\-N\-T32\-\_\-\-T@{\-U\-I\-N\-T32\-\_\-\-T}}\item[{\em 
\hypertarget{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a3730ebad2bf66ba27c4976cc01395baa}{\-U\-I\-N\-T32\-\_\-\-T}\label{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a3730ebad2bf66ba27c4976cc01395baa}
}]\index{\-U\-I\-N\-T64\-\_\-\-T@{\-U\-I\-N\-T64\-\_\-\-T}!grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}}\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!\-U\-I\-N\-T64\-\_\-\-T@{\-U\-I\-N\-T64\-\_\-\-T}}\item[{\em 
\hypertarget{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a70d80c278f2183c3306fd378838bfc25}{\-U\-I\-N\-T64\-\_\-\-T}\label{grouper__fptr_8c_a510e286db24999375ef3f3ed62367ed0a70d80c278f2183c3306fd378838bfc25}
}]\end{description}
\end{Desc}


\begin{DoxyCode}
{ UINT8_T, UINT16_T, UINT32_T, UINT64_T } int_sizes;
\end{DoxyCode}


\subsection{\-Function \-Documentation}
\hypertarget{grouper__fptr_8c_a286a39f0eb4a6f6cd878cb1d66dd274e}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!build\-\_\-record\-\_\-trees@{build\-\_\-record\-\_\-trees}}
\index{build\-\_\-record\-\_\-trees@{build\-\_\-record\-\_\-trees}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{build\-\_\-record\-\_\-trees}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf uniq\-\_\-records\-\_\-tree}$\ast$ {\bf build\-\_\-record\-\_\-trees} (
\begin{DoxyParamCaption}
\item[{char $\ast$$\ast$}]{filtered\-\_\-records, }
\item[{size\-\_\-t}]{num\-\_\-filtered\-\_\-records, }
\item[{struct {\bf grouper\-\_\-rule} $\ast$}]{group\-\_\-modules}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}read\mbox{]}}}}\label{grouper__fptr_8c_a286a39f0eb4a6f6cd878cb1d66dd274e}

\begin{DoxyCode}
                                            {
    struct uniq_records_tree *uniq_records_trees;
    struct tree_item_uint32_t *uniq_records;
    size_t num_uniq_records;
    char ***sorted_records;
    int i;

    sorted_records = (char ***)malloc(sizeof(char **)*(num_filtered_records+1))
      ;
    if (sorted_records == NULL) {
        perror("malloc");
        exit(EXIT_FAILURE);
    }

    for (i = 0; i < num_filtered_records; i++) {
        sorted_records[i] = &filtered_records[i];
    }

    // order by right hand side of comparison
    // TODO: different comp func sizes
    qsort_r(sorted_records, num_filtered_records, sizeof(char **), comp_uint32_t
      , (void *)&group_modules[0].field_offset2);

    uniq_records = (struct tree_item_uint32_t *)malloc(num_filtered_records*
      sizeof(struct tree_item_uint32_t));
    uniq_records[0].value = *(uint32_t *)(*sorted_records[0] + group_modules[0]
      .field_offset2);
    uniq_records[0].ptr = &sorted_records[0];
    num_uniq_records = 1;
    for (i = 0; i < num_filtered_records; i++) {
        if (*(uint32_t *)(*sorted_records[i] + group_modules[0].field_offset2)
                != uniq_records[num_uniq_records-1].value) {
            uniq_records[num_uniq_records].value = *(uint32_t *)(*
      sorted_records[i] + group_modules[0].field_offset2);
            uniq_records[num_uniq_records].ptr = &sorted_records[i];
            num_uniq_records++;
        }
    }
    uniq_records = (struct tree_item_uint32_t *)realloc(uniq_records, 
      num_uniq_records*sizeof(struct tree_item_uint32_t));

    // mark the end of sorted records
    sorted_records[num_filtered_records] = NULL;

    uniq_records_trees = (struct uniq_records_tree *)malloc(1 * sizeof(struct 
      uniq_records_tree));
    if (uniq_records_trees == NULL) {
        perror("malloc");
        exit(EXIT_FAILURE);
    }

    uniq_records_trees[0].type = UINT32_T;
    uniq_records_trees[0].num_uniq_records = num_uniq_records;
    uniq_records_trees[0].uniq_records32 = uniq_records;
    uniq_records_trees[0].sorted_records = sorted_records;

    return uniq_records_trees;
}
\end{DoxyCode}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=298pt]{grouper__fptr_8c_a286a39f0eb4a6f6cd878cb1d66dd274e_cgraph}
\end{center}
\end{figure}


\hypertarget{grouper__fptr_8c_a9cf378e44659c9794c4fe1823920b53f}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp@{comp}}
\index{comp@{comp}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp}]{\setlength{\rightskip}{0pt plus 5cm}{\bf comp} (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a9cf378e44659c9794c4fe1823920b53f}
\hypertarget{grouper__fptr_8c_a92603134048c016522439b1aaa097b3a}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp@{comp}}
\index{comp@{comp}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp}]{\setlength{\rightskip}{0pt plus 5cm}{\bf comp} (
\begin{DoxyParamCaption}
\item[{uint16\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a92603134048c016522439b1aaa097b3a}
\hypertarget{grouper__fptr_8c_afa8a8cd22e54c1d8fc8ca18369c829db}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp@{comp}}
\index{comp@{comp}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp}]{\setlength{\rightskip}{0pt plus 5cm}{\bf comp} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_afa8a8cd22e54c1d8fc8ca18369c829db}
\hypertarget{grouper__fptr_8c_abc0df69d6b432e28aef229d90f08995d}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp@{comp}}
\index{comp@{comp}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp}]{\setlength{\rightskip}{0pt plus 5cm}{\bf comp} (
\begin{DoxyParamCaption}
\item[{uint64\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_abc0df69d6b432e28aef229d90f08995d}
\hypertarget{grouper__fptr_8c_a7f2b2e509cf659c77653fc86648dfa44}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp\-\_\-p@{comp\-\_\-p}}
\index{comp\-\_\-p@{comp\-\_\-p}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp\-\_\-p}]{\setlength{\rightskip}{0pt plus 5cm}{\bf comp\-\_\-p} (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a7f2b2e509cf659c77653fc86648dfa44}
\hypertarget{grouper__fptr_8c_a154c46403f6abdd06cbb5d39c210aae0}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp\-\_\-p@{comp\-\_\-p}}
\index{comp\-\_\-p@{comp\-\_\-p}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp\-\_\-p}]{\setlength{\rightskip}{0pt plus 5cm}{\bf comp\-\_\-p} (
\begin{DoxyParamCaption}
\item[{uint16\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a154c46403f6abdd06cbb5d39c210aae0}
\hypertarget{grouper__fptr_8c_aa2a8894fb9fa7d1dbf8920626ea9e3f1}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp\-\_\-p@{comp\-\_\-p}}
\index{comp\-\_\-p@{comp\-\_\-p}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp\-\_\-p}]{\setlength{\rightskip}{0pt plus 5cm}{\bf comp\-\_\-p} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_aa2a8894fb9fa7d1dbf8920626ea9e3f1}
\hypertarget{grouper__fptr_8c_afc729afdead23ad53bba35b5490b4f34}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!comp\-\_\-p@{comp\-\_\-p}}
\index{comp\-\_\-p@{comp\-\_\-p}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{comp\-\_\-p}]{\setlength{\rightskip}{0pt plus 5cm}{\bf comp\-\_\-p} (
\begin{DoxyParamCaption}
\item[{uint64\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_afc729afdead23ad53bba35b5490b4f34}
\hypertarget{grouper__fptr_8c_aa035e73fc4c57220877467d56e352ee1}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!grouper@{grouper}}
\index{grouper@{grouper}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{grouper}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf group}$\ast$$\ast$ {\bf grouper} (
\begin{DoxyParamCaption}
\item[{char $\ast$$\ast$}]{filtered\-\_\-records, }
\item[{size\-\_\-t}]{num\-\_\-filtered\-\_\-records, }
\item[{struct {\bf grouper\-\_\-rule} $\ast$}]{group\-\_\-modules, }
\item[{int}]{num\-\_\-group\-\_\-modules, }
\item[{struct {\bf grouper\-\_\-aggr} $\ast$}]{aggr, }
\item[{size\-\_\-t}]{num\-\_\-group\-\_\-aggr, }
\item[{size\-\_\-t $\ast$}]{num\-\_\-groups}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}read\mbox{]}}}}\label{grouper__fptr_8c_aa035e73fc4c57220877467d56e352ee1}

\begin{DoxyCode}
{
    struct group **groups;
    struct group *newgroup;
    int i, j, k;
    struct uniq_records_tree *uniq_records_trees;

    *num_groups = 0;
    groups = (struct group **)malloc(sizeof(struct group *));

    if (num_group_modules == 0) {
        for (i = 0; i < num_filtered_records; i++) {
            if ((i&1023)==0) {
                printf("\r%0.2f%% %d/%zd groups: %zd", (i*100.0f)/
      num_filtered_records, i, num_filtered_records, *num_groups);
                fflush(stdout);
            }

            (*num_groups)++;
            groups = (struct group **)realloc(groups, sizeof(struct group*)**
      num_groups);
            newgroup = (struct group *)malloc(sizeof(struct group));
            if (newgroup == NULL) {
                perror("malloc");
                exit(EXIT_FAILURE);
            }
            groups[*num_groups-1] = newgroup;
            newgroup->num_members = 1;
            newgroup->members = (char **)malloc(sizeof(char *));
            newgroup->members[0] = filtered_records[i];
        }
    } else {
        uniq_records_trees = build_record_trees(filtered_records, 
      num_filtered_records, group_modules);

        for (i = 0; i < num_filtered_records; i++) {
            if ((i&1023)==0) {
                printf("\r%0.2f%% %d/%zd groups: %zd", (i*100.0f)/
      num_filtered_records, i, num_filtered_records, *num_groups);
                fflush(stdout);
            }

            if (filtered_records[i] == NULL)
                continue;

            (*num_groups)++;
            groups = (struct group **)realloc(groups, sizeof(struct group*)**
      num_groups);
            newgroup = (struct group *)malloc(sizeof(struct group));
            if (newgroup == NULL) {
                perror("malloc");
                exit(EXIT_FAILURE);
            }
            groups[*num_groups-1] = newgroup;
            newgroup->num_members = 1;
            newgroup->members = (char **)malloc(sizeof(char *));
            newgroup->members[0] = filtered_records[i];

            if (num_group_modules == 0)
                continue;

            // search for left hand side of comparison in records ordered by
       right
            // hand side of comparison
            char ***record_iter = ((struct tree_item_uint32_t *)bsearch_r(
                        filtered_records[i],
                        (void *)uniq_records_trees[0].uniq_records32,
                        uniq_records_trees[0].num_uniq_records,
                        sizeof(struct tree_item_uint32_t),
                        comp_uint32_t_p,
                        (void *)&group_modules[0].field_offset1))->ptr;

            // iterate until terminating NULL in sorted_records
            for (;*record_iter != NULL; record_iter++) {
                // already processed record from filtered_records
                if (**record_iter == NULL)
                    continue;

                // do not group with itself
                if (**record_iter == filtered_records[i])
                    continue;

                // check all module filter rules for those two records
                for (k = 0; k < num_group_modules; k++) {
                    if (!group_modules[k].func(newgroup, group_modules[k].
      field_offset1,
                                **record_iter, group_modules[k].field_offset2, 
      group_modules[k].delta))
                        break;
                }

                // first rule didnt match
                if (k == 0)
                    break;

                // one of the other rules didnt match
                if (k < num_group_modules)
                    continue;

                newgroup->num_members++;
                newgroup->members = (char **)realloc(newgroup->members, sizeof(
      char *)*newgroup->num_members);
                newgroup->members[newgroup->num_members-1] = **record_iter; //
       assign entry in filtered_records to group
                **record_iter = NULL; // set entry in filtered_records to NULL
            }

            filtered_records[i] = NULL;
        }

        // free uniq_records_trees
        free(uniq_records_trees[0].sorted_records);
        free(uniq_records_trees[0].uniq_records32);
        free(uniq_records_trees);
    }

    for (i = 0; i < *num_groups; i++) {
        printf("%p\n", groups[i]);
        groups[i]->aggr = (struct aggr *)malloc(sizeof(struct aggr)*
      num_group_aggr);
        if (groups[i]->aggr == NULL) {
            perror("malloc");
            exit(EXIT_FAILURE);
        }

        for (j = 0; j < num_group_aggr; j++) {
            groups[i]->aggr[j] = aggr[j].func(groups[i]->members, groups[i]->
      num_members, aggr[j].field_offset);
        }
    }

    printf("foobar5\n");
    for (i = *num_groups; i > *num_groups-10; i--) {
        printf("%p\n", groups[i]);
    }

    return groups;
}
\end{DoxyCode}


\-Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{grouper__fptr_8c_aa035e73fc4c57220877467d56e352ee1_cgraph}
\end{center}
\end{figure}


\hypertarget{grouper__fptr_8c_a2989d34d8f06d632175d4457103d2320}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!tree\-\_\-item@{tree\-\_\-item}}
\index{tree\-\_\-item@{tree\-\_\-item}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{tree\-\_\-item}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tree\-\_\-item} (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a2989d34d8f06d632175d4457103d2320}
\hypertarget{grouper__fptr_8c_a54761cb1d00c192a9b4427bd3990932f}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!tree\-\_\-item@{tree\-\_\-item}}
\index{tree\-\_\-item@{tree\-\_\-item}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{tree\-\_\-item}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tree\-\_\-item} (
\begin{DoxyParamCaption}
\item[{uint16\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a54761cb1d00c192a9b4427bd3990932f}
\hypertarget{grouper__fptr_8c_a44b986acfb0170de2ed2f93b5eee9447}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!tree\-\_\-item@{tree\-\_\-item}}
\index{tree\-\_\-item@{tree\-\_\-item}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{tree\-\_\-item}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tree\-\_\-item} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_a44b986acfb0170de2ed2f93b5eee9447}
\hypertarget{grouper__fptr_8c_ad0263c315d3f4b967c3bde99e0b79d40}{\index{grouper\-\_\-fptr.\-c@{grouper\-\_\-fptr.\-c}!tree\-\_\-item@{tree\-\_\-item}}
\index{tree\-\_\-item@{tree\-\_\-item}!grouper_fptr.c@{grouper\-\_\-fptr.\-c}}
\subsubsection[{tree\-\_\-item}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tree\-\_\-item} (
\begin{DoxyParamCaption}
\item[{uint64\-\_\-t}]{}
\end{DoxyParamCaption}
)}}\label{grouper__fptr_8c_ad0263c315d3f4b967c3bde99e0b79d40}
